// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Page {
  id                String          @id @default(cuid())
  title             String
  metadatas         Metadata[]
  type              String          @default("page")
  slug              String?         @unique
  headerId          String?
  header            Element?        @relation(fields: [headerId], references: [id], name: "pageHeader")
  sections          Section[]
  articles          Article[]
  accesses          Access[]
  footerId          String?
  footer            Element?        @relation(fields: [footerId], references: [id], name: "pageFooter")
  published         Boolean         @default(true)
  updatedAt         DateTime        @updatedAt
}

model Access {
  id                String          @id @default(cuid())
  pageId            String
  page              Page            @relation(fields: [pageId], references: [id])
  roleId            String
  role              Role            @relation(fields: [roleId], references: [id])
}

model Metadata {
  id                String          @id @default(cuid())
  name              String
  content           String
  pageId            String?
  page              Page?           @relation(fields: [pageId], references: [id])
}

model Section {
  id                String          @id @default(cuid())
  type              String?
  pageId            String?
  page              Page?           @relation(fields: [pageId], references: [id])
  articleId         String?
  article           Article?        @relation(fields: [articleId], references: [id])
  elementId         String?
  element           Element?        @relation(fields: [elementId], references: [id])
  position          Int
  content           String?  
}

model Element {
  id                String          @id @default(cuid())
  title             String          @unique
  type              String
  section           Section[]
  pageHeaders       Page[]          @relation(name: "pageHeader")  
  pageFooters       Page[]          @relation(name: "pageFooter")
  content           String?
  updatedAt         DateTime        @updatedAt
}

model Media {
  id                String          @id @default(cuid())
  uri               String          @unique
  mimeType          String
  name              String
  size              Int
  alt               String?
  article           Article[]
  uploadTime        DateTime        @default(now())
}

model User {
  id                String          @id @default(cuid())
  name              String?
  login             Login?
  updatedAt         DateTime        @updatedAt
}

model Login {
  id                String          @id @default(cuid())
  userId            String          @unique
  user              User            @relation(fields: [userId], references: [id])
  sessions          Session[]
  roleId            String          @default("user")
  role              Role            @relation(fields: [roleId], references: [id])
  email             String          @unique
  password          String
  updatedAt         DateTime        @updatedAt
}

model Role {
  id                String          @id @default(cuid())
  name              String
  logins            Login[]
  Accesses          Access[]
  updatedAt         DateTime        @updatedAt
}

model Session {
  id                String          @id @default(cuid())
  token             String          @unique
  loginId           String
  login             Login           @relation(fields: [loginId], references: [id])
  expiresAt         DateTime
  updatedAt         DateTime        @updatedAt
}

model Article {
  id                String          @id @default(cuid())
  title             String
  coverId           String?
  cover             Media?          @relation(fields: [coverId], references: [id])
  description       String?
  author            String?
  slug              String          @unique
  sections          Section[]
  pageId            String?
  page              Page?           @relation(fields: [pageId], references: [id])
  published         Boolean         @default(true)
  updatedAt         DateTime        @updatedAt
}

model Setting {
  id                String          @id @default(cuid())
  name              String          @unique
  value             String
  updatedAt         DateTime        @updatedAt
}